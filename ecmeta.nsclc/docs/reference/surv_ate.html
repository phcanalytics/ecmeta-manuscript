<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Average treatment effects for survival data — surv_ate • ecmeta.nsclc</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Average treatment effects for survival data — surv_ate" />
<meta property="og:description" content="Estimate average treatment effects (ATE) from survival data. A Cox proportional
hazards model (survival::coxph()) is used to estimate hazard ratios and
Kaplan-Meier estimators (survival::survfit.formula()) are used to estimate
survivor functions. surv_ate() estimates ATEs for a single group
and map_surv_ate iterates over groups and estimates ATEs for each group.
Confidence intervals for hazard ratios are estimated by clustering on id using
the cluster option in coxph(). Estimates and confidences intervals are pooled
using Rubin's rule when object contains weights from multiply imputed datasets." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ecmeta.nsclc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">API</a>
</li>
<li>
  <a href="../sap/sap.pdf">Analysis plan</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/01-data-prep.html">Data preparation</a>
    </li>
    <li>
      <a href="../articles/02-impute.html">Imputation of missing data</a>
    </li>
    <li>
      <a href="../articles/03-balance.html">Propensity score estimation, weighting, and balance</a>
    </li>
    <li>
      <a href="https://connect.phcaa.science.roche.com/content/1102">Propensity score estimation, weighting, and balance (Shiny app)</a>
    </li>
    <li>
      <a href="../articles/04-ate-trt-ec.html">Treatment effect estimates: RCT experimental vs external control</a>
    </li>
    <li>
      <a href="../articles/05-ic-ec.html">Comparison of the internal and external control arms</a>
    </li>
    <li>
      <a href="../articles/06-ecmeta.html">Meta-analytic adjustment of hazard ratios</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/phcanalytics/ecmeta-manuscript/tree/master/ecmeta.nsclc/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Average treatment effects for survival data</h1>
    <small class="dont-index">Source: <a href='https://github.com/phcanalytics/ecmeta-manuscript/tree/master/ecmeta.nsclc/R/surv_ate.R'><code>R/surv_ate.R</code></a></small>
    <div class="hidden name"><code>surv_ate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate average treatment effects (ATE) from survival data. A Cox proportional
hazards model (<code><a href='https://rdrr.io/pkg/survival/man/coxph.html'>survival::coxph()</a></code>) is used to estimate hazard ratios and
Kaplan-Meier estimators (<code><a href='https://rdrr.io/pkg/survival/man/survfit.formula.html'>survival::survfit.formula()</a></code>) are used to estimate
survivor functions. <code>surv_ate()</code> estimates ATEs for a single group
and <code>map_surv_ate</code> iterates over groups and estimates ATEs for each group.
Confidence intervals for hazard ratios are estimated by clustering on <code>id</code> using
the <code>cluster</code> option in <code>coxph()</code>. Estimates and confidences intervals are pooled
using Rubin's rule when <code>object</code> contains weights from multiply imputed datasets.</p>
    </div>

    <pre class="usage"><span class='fu'>surv_ate</span><span class='op'>(</span>
  <span class='va'>object</span>,
  <span class='va'>ydata</span>,
  <span class='va'>response</span>,
  <span class='va'>id</span>,
  double_adjustment <span class='op'>=</span> <span class='cn'>FALSE</span>,
  ps_stratification <span class='op'>=</span> <span class='cn'>FALSE</span>,
  n_strata <span class='op'>=</span> <span class='fl'>10</span>
<span class='op'>)</span>

<span class='fu'>map_surv_ate</span><span class='op'>(</span>
  <span class='va'>object_list</span>,
  <span class='va'>ydata_list</span>,
  <span class='va'>response</span>,
  <span class='va'>id</span>,
  double_adjustment <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>grp_id</span>,
  integer_grp_id <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object, object_list</th>
      <td><p>Either an object of class <code><a href='psweight.html'>psweight</a></code> or <code>psweight_mi</code> or
a list of such objects.</p></td>
    </tr>
    <tr>
      <th>ydata, ydata_list</th>
      <td><p>Either a data frame containing the response variables
for survival modeling or a list of such objects. Both <code>object</code> and <code>ydata</code>
must contain the <code>id</code> variable.</p></td>
    </tr>
    <tr>
      <th>response</th>
      <td><p>A string containing the response for a survival model.
This is the let hand side of a <code><a href='https://rdrr.io/r/base/tilde.html'>~</a></code> operator.</p></td>
    </tr>
    <tr>
      <th>id</th>
      <td><p>The name of the column in <code>object</code> and <code>ydata</code> identifying each
patient.</p></td>
    </tr>
    <tr>
      <th>double_adjustment</th>
      <td><p>If <code>TRUE</code>, then covariates (in addition to treatment
assignment) are used in the Cox models.</p></td>
    </tr>
    <tr>
      <th>ps_stratification</th>
      <td><p>If <code>TRUE</code>, then models are fit that stratify on
values of the propensity score, with the number of strata determined by
<code>n_strata</code>. Default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>n_strata</th>
      <td><p>Number of strata to divide subjects into based on values of
the propensity score.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code><a href='https://tibble.tidyverse.org/reference/tibble.html'>dplyr::tibble</a></code> with one row for each <code>method</code> in <code>object</code>.
Each row contains the columns: <code>method</code> (the propensity score method),
<code>fit</code> (<code>tibble</code> containing the fitted Cox model),
<code>loghr</code> (<code>tibble</code> containing estimates of the log hazard ratio), and <code>surv</code> (A
<code>tibble</code> containing estimated survival probabilities for both treatment
and control).</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Devin Incerti, Michael Bretscher, Ray Lin, Chris Harbron.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


